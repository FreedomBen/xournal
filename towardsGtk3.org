* Moving Xournal to gtk3

- DO NOT USE YET. This branch is still broken
- There are lots of features that work, but a lot that does not work
- Below I have listed the features that have been ported, but are broken

** Currently working <2013-09-29 Sun>

I am trying to implement adding text...but I am not understanding what
happens in start_text and how to replace it.

[[file:src/xo-paint.c::gtk_widget_modify_font(item->widget,%20font_desc)%3B][file:src/xo-paint.c::gtk_widget_modify_font(item->widget, font_desc);]]


** What is broken seriously (and would impede using it)


*** TODO Loading pdf backgrounds does not  properly display if continous and multipage.
  
- it crashes!!!! now <2013-09-29 Sun>
- Only those pages that are visible in the first screen are rendered... the rest are not.
- At zooming, the same happens, only visible pages are rendered..

*** TODO Annotating PDFs

- Continuous view does not properly rescale the background

*** TODO Selection

- It assert faults under some situations (I think i fixed it). The
  main problem is that rectangles are no longer drawn with four
  points, but with x,y width and height and they do not allow negative
  withds/heights. This means we always have to draw from left/top
  point.  One alternative is to use a path.

- Lasso selection needs to be reimplemented...

*** TODO Undo-Redo

- I think there are issues that need to be implemented. At the very
  least, it needs testing

** TODO cut and paste

- the pasting is incorrectly placed

*** TODO lots of things
Search for WARN or assert(0):

- implement Dialog windows (there is a deprecation in gtk3 that I need
  to fix). This affects everything that creates a dialog window.
- inserting images
- inserting text
- undo/redo of some items 
- print (I think)

** Minor issues that need to be looked at

*** TODO Cursor shapes

- I have observed some cases in which the shape of the mouse during
  resizing of a region stays even after the resizing. Needs investigation. I think I have broken setting the cursor shape

*** TODO it does not center the screen in the canvas when it is rezized




*** TODO the screen needs to be redrawn after each line, because there are aliasing artifacts :minor:

*** TODO selection polygons are not dashed, but red 		      :minor:

- Dashing the polygons (rectangle and polygon) requires deleting it and adding it again...

* Other notes

ignore from here on. This are my notes...

** Example of a port

http://www.gtkforums.com/viewtopic.php?p=9858



** Strategy

- The API is going to be different
- First get the canvas drawn with the background
- ifdef everything else

** to be done

https://developer.gnome.org/libgnomecanvas/stable/GnomeCanvas.htm
http://www.gnu.org/software/guile-gnome/docs/libgnomecanvas/html/Function-Index.html#Function-Index

These are all the instances of functions used by gnomecanvas that must be replaced


gnome_canvas_get_scroll_offsets
gnome_canvas_group_get_type

https://developer.gnome.org/goocanvas/unstable/GooCanvasItem.html

http://www.gnu.org/software/guile-gnome/docs/libgnomecanvas/html/GnomeCanvasItem.html#GnomeCanvasItem


  To convert between world and item coordinate systems call
  gnome-canvas-item-w2i, and to convert in the other direction call
  gnome-canvas-item-i2w. To get the transform for converting from item
  to world coordinates use gnome-canvas-item-i2w-affine or for
  converting item to canvas coordinates, gnome-canvas-item-i2c-affine.


| old       | new                       |
| w->window | gtk_widget_get_window(w); |


| gnomecanvas                       | goo                  |                                                                                    |
|-----------------------------------+----------------------+------------------------------------------------------------------------------------|
| gnome_canvas_item_affine_absolute | goo_canvas_get_scale | https://developer.gnome.org/goocanvas/unstable/GooCanvas.html#goo-canvas-get-scale |
| gnome_canvas_item_hide            |                      |                                                                                    |
| gnome_canvas_item_lower           |                      |                                                                                    |
| gnome_canvas_item_move            |                      |                                                                                    |
| gnome_canvas_item_new             |                      |                                                                                    |
| gnome_canvas_item_raise           |                      |                                                                                    |
| gnome_canvas_item_reparent        |                      |                                                                                    |
| gnome_canvas_item_set             |                      |                                                                                    |
| gnome_canvas_item_show            |                      |                                                                                    |


|                            |   |                               |
| gnome_canvas_line_get_type |   |                               |
| gnome_canvas_new_aa        |   | creates new antialized canvas |
|                            |   |                               |

https://developer.gnome.org/goocanvas/unstable/GooCanvasPath.html
g
nome_canvas_path_def_closepath
gnome_canvas_path_def_lineto
gnome_canvas_path_def_moveto
gnome_canvas_path_def_new_sized
gnome_canvas_path_def_unref



gnome_canvas_pixbuf_get_type
gnome_canvas_points_free
gnome_canvas_points_new
gnome_canvas_polygon_get_type
gnome_canvas_rect_get_type
gnome_canvas_root
gnome_canvas_scroll_to

gnome_canvas_set_center_scroll_region 



| gnome_canvas_set_pixels_per_unit |                       |      |
| gnome_canvas_set_pixels_per_unit |                       |      |
| gnome_canvas_set_scroll_region   | goo_canvas_set_bounds | Done |

gnome_canvas_text_get_type


gnome_canvas_widget_get_type
gnome_canvas_window_to_world

** On units

Apparently the units are handled by just setting the type of unit. No conversion is needed.

https://developer.gnome.org/goocanvas/unstable/GooCanvas.html#GooCanvas--units
